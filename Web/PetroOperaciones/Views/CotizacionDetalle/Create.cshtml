@model PetroOperaciones.Models.Cotizacion.CotizacionViewModel
       
@{
    Layout = "~/Views/Shared/_LayoutAdministrator.cshtml";
    ViewBag.Title = "Create";
}




<script type="text/javascript">
    $(function () {
        $('#ConceptoID').attr('rel', '1');
        $('#CotizacionEncabezadoID').attr('value', '@Model.CotizacionEncabezado.CotizacionEncabezadoID');

    });
	
</script>

<script type="text/javascript">
    function enviarFormulario() {
        document.getElementById("formId").submit();
    }


</script>
<fieldset class="ConsolidadosReportes">
<p><h2>Cotización No.  @Model.CotizacionEncabezado.CotizacionEncabezadoID  Fecha Cotización @Model.CotizacionEncabezado.FechaCotizacion.ToShortDateString()</h2>  </p>

	<table class="gt_tbl_searchparameters">
			<tr>
				<td class="tbl_name_short">Cliente @ViewBag.xml</td>
				<td colspan="9" >@Model.CotizacionEncabezado.ClienteNm</td>
			</tr>

			<tr>
				<td class="tbl_name_short">Atensión Sr @ViewBag.xml</td>
				<td colspan="9">@Model.CotizacionEncabezado.AtencionSr</td>
			</tr>

			<tr>
				<td class="tbl_name_short">Dirección</td>
				<td>@Model.CotizacionEncabezado.Direccion</td>

				<td class="tbl_name_short">Teléfono</td>
				<td>@Model.CotizacionEncabezado.Telefono</td>

				<td class="tbl_name_short">Email</td>
				<td>@Model.CotizacionEncabezado.Email</td>
			</tr>

			<tr>
				<td class="tbl_name_short">Tasa de Cambio</td>
				<td>$ @Model.CotizacionEncabezado.TasaDeCambio</td>
				<td class="tbl_name_short">Vigencia</td> 
				<td>@Model.CotizacionEncabezado.FechaVigencia</td>
			</tr>

			<tr>
				<td class="tbl_name">Anotaciones</td> 
				<td colspan="9" >@Model.CotizacionEncabezado.Anotaciones</td>
			</tr>
            
	</table>

	<table class="gt_tbl_searchparameters"  >

			<tr>
				<td class="tbl_name_short">Peso Apróx.</td>
				<td>@Model.CotizacionEncabezado.PesoAprox</td>

				<td class="tbl_name_short">Volumen</td>
				<td>@Model.CotizacionEncabezado.Volumen</td>

				<td class="tbl_name_short">Dimensiones</td>
				<td>@Model.CotizacionEncabezado.Dimensiones</td>



				<td class="tbl_name_short">Producto</td>
				<td>@Model.CotizacionEncabezado.Producto</td>

	        </tr>
            <tr>
            	<td class="tbl_name_short">KG AF</td>
				<td>@Model.CotizacionEncabezado.KGAF</td>

				<td class="tbl_name_short">KG BR</td>
				<td>@Model.CotizacionEncabezado.KGBR</td>
				<td class="tbl_name_short">Origen</td>
				<td>@Model.CotizacionEncabezado.PuertoO.PuertoNm</td>

				<td class="tbl_name_short">Destino</td>
				<td>@Model.CotizacionEncabezado.PuertoD.PuertoNm</td>
    			
			</tr>			
   

	</table>



      			

    
<link href="@Url.Content("~/Content/demo_table_jui.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/table/complete.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/table/jquery.dataTables.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/table/jquery.dataTables.editable.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/table/jquery.jeditable.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/table/jquery-ui.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/table/jquery.validate.js")" type="text/javascript"></script>

    



<script type="text/javascript" charset="utf-8">
		    $(document).ready(function () {
		        var id = -1; //simulation of id
		        $('#example').dataTable({ bJQueryUI: true,

		            "sPaginationType": "full_numbers"
		        }).makeEditable({

		            sAddURL: "AddData",
		            sAddHttpMethod: "GET",
		            sDeleteHttpMethod: "GET",
                    sDeleteURL: "DeleteData",
                    	"aoColumns": [
                    			        { 	
																					
								        },
														
														
                    			        {
                                         
				
                    			        },
                    			        {
                					
         
                    			        },
                    			        {
   
                    			        },
                    			        {
                        
								        }
								    ],
            oAddNewRowButtonOptions: { label: "Agregar",
		                icons: { primary: 'ui-icon-plus' }
		            },
		            oDeleteRowButtonOptions: { label: "Eliminar",
		                icons: { primary: 'ui-icon-trash' }
		            },
                               oAddNewRowOkButtonOptions: {
				label: "Aceptar",
                                icons: { primary: 'ui-icon-check' },
                                name: "action",
                                value: "add-new"
                            },
                            oAddNewRowCancelButtonOptions: { 
				label: "Cerrar",
                                class: "back-class",
                                name: "action",
                                value: "cancel-add",
                                icons: { primary: 'ui-icon-close' }
                            },
		            oAddNewRowFormOptions: {
		                title: 'Agregar Concepto',
		                show: "blind",
		                hide: "explode",
		                modal: true
		            },
		            sAddDeleteToolbarSelector: ".dataTables_length"

		        });

		    });
		</script>



	


				



<table  class="display" id="example">
	<thead>
		<tr>
			<th>Tipo de Concepto</th>
			<th>Concepto</th>
            <th>Detalles</th>
			<th>Valor COP</th>
			<th>Valor USD</th>
			<th>Unidades</th>
		</tr>
	</thead>
	<tfoot>

		<tr>
			<th>Tipo de Concepto</th>
			<th>Concepto</th>
            <th>Detalles</th>
			<th>Valor COP</th>
			<th>Valor USD</th>
			<th>Unidades</th>
		</tr>


	</tfoot>
	<tbody>

    @foreach (var item in Model.Detalles)
    {
        <tr id="@Html.DisplayFor(modelItem => item.CotizacionDetalleID)">
            <td class="read_only">
               @Html.DisplayFor(modelItem => item.TipoConceptoCotizacion.TipoConceptoCotizacionID)
            </td>

            <td class="read_only">
               @Html.DisplayFor(modelItem => item.ConceptoNm)
            </td>

            <td class="read_only">
               @Html.DisplayFor(modelItem => item.Detalles)
            </td>

            <td class="read_only">
              $ @Html.DisplayFor(modelItem => item.ValorCOP)
            </td>

            <td class="read_only">
             $ @Html.DisplayFor(modelItem => item.ValorUSD)
            </td>
            <td class="read_only">
               @Html.DisplayFor(modelItem => item.Unidades)
            </td>

        </tr>
    }
	</tbody>
</table>

<br />

 <div id="gt_box_contbuttons">
    
    <a class="ui-button ui-button-exppdf ui-float-left" href="GetQuotePDFFile?CotizacionEncabezadoID=@Model.CotizacionEncabezado.CotizacionEncabezadoID&tipoMoneda=COP"><span class="ui-button-img">&nbsp;</span><span class="ui-button-txt">Generar en Pesos</span></a>
    <a class="ui-button ui-button-exppdf ui-float-left" href="GetQuotePDFFile?CotizacionEncabezadoID=@Model.CotizacionEncabezado.CotizacionEncabezadoID&tipoMoneda=USD"><span class="ui-button-img">&nbsp;</span><span class="ui-button-txt">Generar en Dolares</span></a>
    <a class="ui-button ui-button-exppdf ui-float-left" href="GetQuotePDFFile?CotizacionEncabezadoID=@Model.CotizacionEncabezado.CotizacionEncabezadoID&tipoMoneda=COPUSD"><span class="ui-button-img">&nbsp;</span><span class="ui-button-txt">Generar en COP y USD</span></a>
    
</div>   


</fieldset>

<div id="gt_box_contbuttons">

    <a class="ui-button ui-button-volver ui-float-left" href="javascript:history.go(-1)"><span class="ui-button-img">&nbsp;</span><span class="ui-button-txt">Regresar</span></a>
    
</div>


<script type="text/javascript">

    $(function () {
        



    });
    function actualizarMonto(form) {

        var montoOriginal = form.valorMoneda.value;
        var monto = "";
        if (isNumber(montoOriginal)) {
            monto = montoOriginal;
        }

        else {
            form.valorCOP.value = "$ 0";
            form.valorUSD.value = "$ 0";
        }

        var moneda = form.moneda.value;


        if (monto != "") {

            var tasaCambio = limpiarTasaCambio(form.tasaCambioPrefactura.value); 

            if (moneda === "USD") {
                var montoEnPesos = monto * tasaCambio;
                form.valorCOP.value = formatCurrency(montoEnPesos);
                form.valorUSD.value = formatCurrency(monto);
            }

            else if (moneda === "COP") {
                var montoEnDolares = monto / tasaCambio;
                form.valorCOP.value = formatCurrency(monto);
                form.valorUSD.value = formatCurrency(montoEnDolares);
            }
        }



    }


    function limpiarTasaCambio(tasaCambio) {
        var str2 = tasaCambio.replace(".", "");
        var str3 = str2.replace(",", ".");
        return str3;
    }


</script>

   <script src="@Url.Content("~/Scripts/Validador.js")" type="text/javascript"></script>

				
<form id="formAddNewRow" action="#">
<table style='font-size:12px;'  align='center'>

	<tr>
        <td>Tipo Concepto</td>
    </tr>
    <tr>
        <td>	    
            <select name="tipoConcepto" id="tipoConcepto" rel="0">
                    <option value='1'>GASTOS POR FLETE (MARITIMO/AEREO) INTERNACIONAL</option>
                    <option value='2'>GASTOS EN ORIGEN</option>
                    <option value='3'>GASTOS EN DESTINO</option>
                    <option value='4'>AGENCIAMIENTO ADUANEROS</option>

            </select>
        </td>
	</tr>

	<tr>
        <td>Concepto</td>
    </tr>
    <tr>
        <td>	    
            @Html.DropDownList("ConceptoID")
        </td>
	</tr>

	<tr>
        <td>Descripción</td>
    </tr>
    <tr>
        <td>
            <input type="text" name="detalles"   rel="2" />	     
        </td>
	</tr>

	<tr>
        <td>Moneda</td>
    </tr>
    <tr>
        <td>	    
	        <select name="moneda" id="moneda" onchange="actualizarMonto(this.form)">
                    <option value="COP">Pesos</option>
                    <option value="USD">Dolares</option>                
            </select>
        </td>
	</tr>

	<tr>
        <td>Valor</td>
    </tr>
    <tr>
        <td>	    
         <input type="text" name="valorMoneda"  onblur="actualizarMonto(this.form)" />
        </td>
	</tr>

	<tr>
        <td>Unidades</td>
    </tr>
    <tr>
        <td>	    
          <input type="text" name="soporte" rel="5" />
        </td>
	</tr>

  </table>

  <input type="hidden" name="tasaCambioPrefactura" id="tasaCambioPrefactura" value="@Model.CotizacionEncabezado.TasaDeCambio"  />
  <input type="hidden" name="valorCOP" id="valorCOP" rel="3"  />
  <input type="hidden" name="valorUSD" id="valorUSD" rel="4"  />
  <input type="hidden" name="CotizacionEncabezadoID" id="CotizacionEncabezadoID"  />

</form>